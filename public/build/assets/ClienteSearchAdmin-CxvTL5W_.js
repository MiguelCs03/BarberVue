import{g as i,B as x,c as n,b as e,d as m,t as d,k,v as E,p as N,G as P,F as j,r as q,C as A,o as c}from"./app-SE4O8QdG.js";const L={class:"mb-6 p-4 border-b",style:{borderColor:"var(--border-color)"}},T={key:0,class:"p-4 rounded-lg mb-4",style:{backgroundColor:"var(--color-success-light)",borderLeft:"4px solid var(--color-success)"}},U={class:"flex justify-between items-center"},$={style:{color:"var(--text-secondary)"}},D={key:1},F={class:"flex gap-4 mb-4"},K=["disabled"],M={key:0,class:"border rounded-lg overflow-hidden",style:{borderColor:"var(--border-color)"}},O={class:"max-h-80 overflow-y-auto"},G={class:"w-full"},R={class:"px-4 py-3",style:{color:"var(--text-primary)"}},z={class:"px-4 py-3",style:{color:"var(--text-secondary)"}},H={class:"px-4 py-3 text-center"},I=["onClick"],J={key:0,class:"flex justify-between items-center px-4 py-3 border-t",style:{borderColor:"var(--border-color)",backgroundColor:"var(--bg-secondary)"}},Q=["disabled"],W={style:{color:"var(--text-secondary)"}},X=["disabled"],Y={key:1,class:"text-sm mt-2 text-center py-4",style:{color:"var(--text-secondary)"}},ee={__name:"ClienteSearchAdmin",props:{modelValue:{type:Object,default:null}},emits:["update:modelValue","cleared"],setup(w,{emit:B}){const _=w,h=B,p=i("username"),u=i(""),l=i([]),v=i(!1),y=i(!1),t=i({current_page:1,last_page:1,per_page:10,total:0}),s=i(_.modelValue);x(()=>_.modelValue,a=>{s.value=a}),x(s,a=>{h("update:modelValue",a)});const g=async(a=1)=>{const o=u.value.trim();if(o.length<2){alert("Por favor, ingresa al menos 2 caracteres para buscar");return}v.value=!0,y.value=!0;try{const r=p.value==="username"?"/usuarios/busqueda-cliente-username":"/usuarios/busqueda-cliente-email",C=p.value==="username"?"username":"email",b=await A.get(r,{params:{[C]:o,page:a}});l.value=b.data.data||[],t.value={current_page:b.data.current_page||1,last_page:b.data.last_page||1,per_page:b.data.per_page||10,total:b.data.total||0}}catch(r){console.error("Error al buscar clientes:",r),l.value=[],alert("Error al buscar clientes. Por favor intenta nuevamente.")}finally{v.value=!1}},f=a=>{a>=1&&a<=t.value.last_page&&g(a)},V=a=>{s.value=a,l.value=[],u.value="",y.value=!1},S=()=>{s.value=null,l.value=[],u.value="",y.value=!1,h("cleared")};return x(p,()=>{l.value=[],y.value=!1}),(a,o)=>(c(),n("div",L,[o[7]||(o[7]=e("h3",{class:"text-lg font-semibold mb-3",style:{color:"var(--text-primary)"}}," Buscar Cliente (Opcional) ",-1)),o[8]||(o[8]=e("p",{class:"text-sm mb-4",style:{color:"var(--text-secondary)"}}," Puedes buscar un cliente específico o continuar sin seleccionar uno para ver disponibilidad general ",-1)),s.value?(c(),n("div",T,[e("div",U,[e("div",null,[o[4]||(o[4]=e("p",{class:"font-semibold",style:{color:"var(--text-primary)"}}," Cliente seleccionado: ",-1)),e("p",$,d(s.value.name)+" ("+d(s.value.email)+") ",1)]),e("button",{onClick:S,class:"px-4 py-2 rounded-lg hover:opacity-80 transition-opacity",style:{backgroundColor:"var(--color-danger)",color:"white"}}," Limpiar ")])])):m("",!0),s.value?m("",!0):(c(),n("div",D,[e("div",F,[k(e("select",{"onUpdate:modelValue":o[0]||(o[0]=r=>p.value=r),class:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2",style:{borderColor:"var(--border-color)",backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"}},[...o[5]||(o[5]=[e("option",{value:"username"},"Buscar por Usuario",-1),e("option",{value:"email"},"Buscar por Email",-1)])],512),[[E,p.value]]),k(e("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>u.value=r),type:"text",class:"flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2",style:{borderColor:"var(--border-color)",backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"},placeholder:"Escribe el usuario o email...",onKeyup:P(g,["enter"])},null,544),[[N,u.value]]),e("button",{onClick:g,disabled:u.value.length<2||v.value,class:"px-6 py-2 rounded-lg hover:opacity-80 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"var(--color-primary)",color:"white"}},d(v.value?"Buscando...":"Buscar"),9,K)]),l.value.length>0?(c(),n("div",M,[e("div",O,[e("table",G,[o[6]||(o[6]=e("thead",{class:"sticky top-0",style:{backgroundColor:"var(--bg-secondary)"}},[e("tr",{style:{borderBottom:"2px solid var(--border-color)"}},[e("th",{class:"px-4 py-3 text-left font-semibold",style:{color:"var(--text-primary)"}}," Nombre "),e("th",{class:"px-4 py-3 text-left font-semibold",style:{color:"var(--text-primary)"}}," Email "),e("th",{class:"px-4 py-3 text-center font-semibold",style:{color:"var(--text-primary)"}}," Acción ")])],-1)),e("tbody",null,[(c(!0),n(j,null,q(l.value,r=>(c(),n("tr",{key:r.id,class:"border-b last:border-b-0 hover:bg-opacity-50 transition-colors",style:{borderColor:"var(--border-color)"}},[e("td",R,d(r.name),1),e("td",z,d(r.email),1),e("td",H,[e("button",{onClick:C=>V(r),class:"px-4 py-2 rounded-lg hover:opacity-80 transition-opacity",style:{backgroundColor:"var(--color-primary)",color:"white"}}," Seleccionar ",8,I)])]))),128))])])]),t.value.last_page>1?(c(),n("div",J,[e("button",{onClick:o[2]||(o[2]=r=>f(t.value.current_page-1)),disabled:t.value.current_page===1,class:"px-4 py-2 rounded-lg hover:opacity-80 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"var(--color-primary)",color:"white"}}," Anterior ",8,Q),e("span",W," Página "+d(t.value.current_page)+" de "+d(t.value.last_page),1),e("button",{onClick:o[3]||(o[3]=r=>f(t.value.current_page+1)),disabled:t.value.current_page===t.value.last_page,class:"px-4 py-2 rounded-lg hover:opacity-80 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"var(--color-primary)",color:"white"}}," Siguiente ",8,X)])):m("",!0)])):m("",!0),y.value&&l.value.length===0&&!v.value?(c(),n("p",Y," No se encontraron clientes con ese criterio de búsqueda ")):m("",!0)]))]))}};export{ee as default};
